scheduler.attachEvent("onTemplatesReady",function(){function s(e,t,i,l){for(var s=t.getElementsByTagName(e),o=i.getElementsByTagName(e),n=o.length-1;0<=n;n--){i=o[n];if(l){var h=document.createElement("SPAN");h.className="dhx_text_disabled",h.innerHTML=l(s[n]),i.parentNode.insertBefore(h,i),i.parentNode.removeChild(i)}else i.disabled=!0,t.checked&&(i.checked=!0)}}var a=scheduler.config.lightbox.sections.slice(),d=scheduler.config.buttons_left.slice(),g=scheduler.config.buttons_right.slice();scheduler.attachEvent("onBeforeLightbox",function(e){if(this.config.readonly_form||this.getEvent(e).readonly){this.config.readonly_active=!0;for(var t=0;t<this.config.lightbox.sections.length;t++)this.config.lightbox.sections[t].focus=!1}else this.config.readonly_active=!1,scheduler.config.lightbox.sections=a.slice(),scheduler.config.buttons_left=d.slice(),scheduler.config.buttons_right=g.slice();var i=this.config.lightbox.sections;if(this.config.readonly_active){for(t=0;t<i.length;t++)if("recurring"==i[t].type){this.config.readonly_active&&i.splice(t,1);break}var l=["dhx_delete_btn","dhx_save_btn"],s=[scheduler.config.buttons_left,scheduler.config.buttons_right];for(t=0;t<l.length;t++)for(var o=l[t],n=0;n<s.length;n++){for(var h=s[n],r=-1,c=0;c<h.length;c++)if(h[c]==o){r=c;break}-1!=r&&h.splice(r,1)}}return this.resetLightbox(),!0});var o=scheduler._fill_lightbox;scheduler._fill_lightbox=function(){var e=this.getLightbox();this.config.readonly_active&&(e.style.visibility="hidden",e.style.display="block");var t=o.apply(this,arguments);if(this.config.readonly_active&&(e.style.visibility="",e.style.display="none"),this.config.readonly_active){var i=this.getLightbox(),l=this._lightbox_r=i.cloneNode(!0);l.id=scheduler.uid(),s("textarea",i,l,function(e){return e.value}),s("input",i,l,!1),s("select",i,l,function(e){return e.options.length?e.options[Math.max(e.selectedIndex||0,0)].text:""}),i.parentNode.insertBefore(l,i),n.call(this,l),scheduler._lightbox&&scheduler._lightbox.parentNode.removeChild(scheduler._lightbox),this._lightbox=l,scheduler.config.drag_lightbox&&(l.firstChild.onmousedown=scheduler._ready_to_dnd),this.setLightboxSize(),l.onclick=function(e){var t=e?e.target:event.srcElement;if(t.className||(t=t.previousSibling),t&&t.className)switch(t.className){case"dhx_cancel_btn":scheduler.callEvent("onEventCancel",[scheduler._lightbox_id]),scheduler._edit_stop_event(scheduler.getEvent(scheduler._lightbox_id),!1),scheduler.hide_lightbox()}}}return t};var n=scheduler.showCover;scheduler.showCover=function(){this.config.readonly_active||n.apply(this,arguments)};var e=scheduler.hide_lightbox;scheduler.hide_lightbox=function(){return this._lightbox_r&&(this._lightbox_r.parentNode.removeChild(this._lightbox_r),this._lightbox_r=this._lightbox=null),e.apply(this,arguments)}});