!function(){function _(e){delete e.rec_type,delete e.rec_pattern,delete e.event_pid,delete e.event_length}var o,c=!1,i=null;scheduler.attachEvent("onBeforeLightbox",function(){return c=!0}),scheduler.attachEvent("onAfterLightbox",function(){return!(c=!1)}),scheduler.attachEvent("onMouseMove",function(e,t){o=scheduler.getActionData(t).date}),dhtmlxEvent(document,_isOpera?"keypress":"keydown",function(e){if(e=e||event,!c){var t=window.scheduler;if(37==e.keyCode||39==e.keyCode){e.cancelBubble=!0;var n=t.date.add(t._date,37==e.keyCode?-1:1,t._mode);return t.setCurrentView(n),!0}var a=t._select_id;if(e.ctrlKey&&67==e.keyCode)return a&&(t._buffer_id=a,i=!0,t.callEvent("onEventCopied",[t.getEvent(a)])),!0;if(e.ctrlKey&&88==e.keyCode&&a){i=!1,t._buffer_id=a;var d=t.getEvent(a);t.updateEvent(d.id),t.callEvent("onEventCut",[d])}if(e.ctrlKey&&86==e.keyCode){if(d=t.getEvent(t._buffer_id)){var r=d.end_date-d.start_date;if(i){var l=t._lame_clone(d);_(l),l.id=t.uid(),l.start_date=new Date(o),l.end_date=new Date(l.start_date.valueOf()+r),t.addEvent(l),t.callEvent("onEventPasted",[i,l,d])}else{var v=t._lame_copy({},d);_(v),v.start_date=new Date(o),v.end_date=new Date(v.start_date.valueOf()+r),t.callEvent("onBeforeEventChanged",[v,e,!1,t._drag_event])&&(d.start_date=new Date(v.start_date),d.end_date=new Date(v.end_date),t.render_view_data(),t.callEvent("onEventPasted",[i,d,v]),i=!0)}}return!0}}})}();