<div class="container">
  <div class="box">

<div class="col-lg-12">
                <hr>
                <h2 class="intro-text text-center">
                    <strong>Users</strong>
                </h2>
                <hr>
            </div>


<%= link_to "All Users", :action => "index" %>
|
<%= link_to "Users awaiting approval", :action => "index", :approved => "false" %>
<br/><br/>
    <div class="col-md-12">
      <table class="table">
        <tbody>
          <% @users.each do |user| %>
            <tr>
              <%= render user %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

</div>
<script type="text/javascript">
 
  $('select.checkbox').multiselect({buttonWidth:200, numberDisplayed: 2, multiple: true, onChange: function(element, checked) {
        var form = $(element).closest("form");
        update_user(form);
      }
    });
    $('select.role').multiselect( { buttonWidth:80, onChange: function(element, checked) {
        var form = $(element).closest("form"); 
       update_user(form);
      }
    });

    function update_user(form){
       $(form).find(".loading").show();
      jQuery.ajax({
        type: "POST",
        dataType: 'json',
        data: $(form).serialize(),
        url:  $(form).attr('action'),
        success: function(data) {
          $(form).find(".loading").hide();
          $(form).find(".check").show();
        }.bind(this),
        error: function(error) {
            alert(error);
        }.bind(this),
        timeout: 30000
      });
    }

</script>



